import java.sql.ResultSet;
import java.sql.SQLException;
import java.util.ArrayList;

import Vectors.Zeitreihe;

/**
 * 
 */

/**
 * @author mawo
 *
 */
public class FeatureWriter {
	private DBConnect db;
	private String name;
	
	public FeatureWriter (DBConnect database, boolean normalisiert) {
		db = database;
		if (normalisiert) name = "NormWirkleistung";
		else name = "Wirkleistung";
	}
	
	public void zeitreihe (String input, String output, int start, int end) throws SQLException{
		ResultSet rs = db.getSQL(input);
		String values;
		rs.first();
		//Zeitreihe zr = new Zeitreihe(rs, normalisiert);
		//ArrayList<String> names = zr.listFeatures();
		/*while (!rs.isLast()) {
			ArrayList<Double> features = zr.getFeatureVector(rs.getInt("Unixtime"));
			values = " VALUES (" + rs.getInt("Unixtime") + ", ";
			for (Double w : features) {
				values += w + ", ";
			}
			values += rs.getInt("Klasse") + ")";
			System.out.println(output+ values);
			db.setSQL(output + values);
			rs.next();
		}*/
		while (!rs.isLast()) {
			values = " VALUES (" + rs.getInt("Unixtime") + ", ";
			for (int i = 0; i < 10; i++) rs.previous();
			for (int i = -10; i < 10; i++){
				values += rs.getDouble(name);
			}
			for (int i = 0; i < 10; i++) rs.previous();
			values += rs.getInt("Klasse") + ")";
			System.out.println(output+ values);
			db.setSQL(output + values);
			rs.next();
		}
	}

}
