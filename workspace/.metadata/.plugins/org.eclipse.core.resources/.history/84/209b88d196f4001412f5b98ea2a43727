import java.sql.ResultSet;
import java.sql.SQLException;

/**
 * 
 */

/**
 * @author mawo
 *
 */
public class Expander {
	private DBConnect db;
	
	public Expander(DBConnect database) {
		db = database;
	}
	
	public void expand(String input, String output, int start, int length) throws SQLException{
		String values;
		ResultSet rs = db.getSQL(input);
		rs.first();
		while (!rs.isLast()) {
			int now = rs.getInt("Unixtime");
			values = "VALUES ('" + rs.getInt("Unixtime") + "', ";
			values += "'" + rs.getInt("Spannung") + "', ";
			values += "'" + rs.getInt("Stromstärke") + "', ";
			values += "'" + rs.getInt("Wirkleistung") + "')";
			db.getSQL(output + values);
			rs.next();
			int next = rs.getInt("Unixtime");
			if (next > now + 1) {
				rs.previous();
				for (int i = 1; i < next - now; i++){
					values = "VALUES ('" + rs.getInt("Unixtime") + i + "', ";
					values += "'" + rs.getInt("Spannung") + "', ";
					values += "'" + rs.getInt("Stromstärke") + "', ";
					values += "'" + rs.getInt("Wirkleistung") + "')";
					db.getSQL(output + values);
				}
				rs.next();
			}
			
		}
	}

}
