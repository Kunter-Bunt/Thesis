import java.io.BufferedWriter;
import java.io.FileOutputStream;
import java.io.FileWriter;
import java.io.ObjectOutputStream;

import weka.classifiers.meta.FilteredClassifier;
import weka.core.Instances;

/**
 * 
 */

/**
 * @author mawo
 *
 */
public class ClassifyData implements Runnable {
	private Thread t;
	   private String threadName;
	   private Instances data;
	   private FilteredClassifier fc;
	   public String res = "";
	   private String path;
	   
	   public ClassifyData(String name){
	       threadName = name;
	       System.out.println("Creating " +  threadName );
	   }
	   
	   public void run() {
	      System.out.println("Running " +  threadName );
	      synchronized(this){
		      try { 
		    	  Instances labeled = new Instances(data);
		    	  for (int i = 0; i < data.numInstances(); i++) {
		    		   double clsLabel = fc.classifyInstance(data.instance(i));
		    		   labeled.instance(i).setClassValue(clsLabel);
		    		 }
		    		 // save labeled data
		    		 BufferedWriter writer = new BufferedWriter(
		    		                           new FileWriter(path));
		    		 writer.write(labeled.toString());
		    		 writer.newLine();
		    		 writer.flush();
		    		 writer.close(); 
					 res = "finished";
		     } catch (Exception e) {
		         System.out.println(e);
		     }
		     System.out.println("Thread " +  threadName + " exiting.");
		     notifyAll();
	     }
	   }
	   
	   public void start (Instances data, FilteredClassifier fc, String path)
	   {
		  this.data = data;
		  this.fc = fc;
		  this.path = path;
	      System.out.println("Starting " +  threadName );
	      if (t == null)
	      {
	         t = new Thread (this, threadName);
	         t.start ();
	      }
	   }
}
